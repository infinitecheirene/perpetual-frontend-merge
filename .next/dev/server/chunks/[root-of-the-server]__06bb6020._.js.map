{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/raiza/OneDrive/Documents/Github/perpetual_merged/perpetual_frontend/app/api/trigger-announcement-email/route.ts"],"sourcesContent":["// app/api/trigger-announcement-email/route.ts\r\nimport { NextRequest, NextResponse } from 'next/server';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const body = await request.json();\r\n    const { announcement } = body;\r\n\r\n    if (!announcement) {\r\n      return NextResponse.json(\r\n        { success: false, message: 'Announcement data is required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Prepare email data\r\n    const emailData = {\r\n      title: announcement.title,\r\n      description: announcement.description,\r\n      content: announcement.content,\r\n      category: announcement.category,\r\n      date: new Date(announcement.date).toLocaleDateString('en-US', {\r\n        year: 'numeric',\r\n        month: 'long',\r\n        day: 'numeric',\r\n      }),\r\n    };\r\n\r\n    // Call the bulk email API route\r\n    const response = await fetch(`${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/api/send-bulk-email`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        type: 'announcement',\r\n        data: emailData,\r\n      }),\r\n    });\r\n\r\n    const result = await response.json();\r\n\r\n    if (!response.ok) {\r\n      throw new Error(result.message || 'Failed to send emails');\r\n    }\r\n\r\n    console.log('Announcement emails triggered:', result);\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: 'Announcement emails sent successfully',\r\n      results: result.results,\r\n    });\r\n\r\n  } catch (error: any) {\r\n    console.error('Error triggering announcement emails:', error);\r\n    return NextResponse.json(\r\n      { success: false, message: 'Failed to send announcement emails', error: error.message },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA,8CAA8C;AAC9C;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,YAAY,EAAE,GAAG;QAEzB,IAAI,CAAC,cAAc;YACjB,OAAO,0LAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,SAAS;YAAgC,GAC3D;gBAAE,QAAQ;YAAI;QAElB;QAEA,qBAAqB;QACrB,MAAM,YAAY;YAChB,OAAO,aAAa,KAAK;YACzB,aAAa,aAAa,WAAW;YACrC,SAAS,aAAa,OAAO;YAC7B,UAAU,aAAa,QAAQ;YAC/B,MAAM,IAAI,KAAK,aAAa,IAAI,EAAE,kBAAkB,CAAC,SAAS;gBAC5D,MAAM;gBACN,OAAO;gBACP,KAAK;YACP;QACF;QAEA,gCAAgC;QAChC,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,GAAG,CAAC,mBAAmB,IAAI,wBAAwB,oBAAoB,CAAC,EAAE;YAChH,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,MAAM;gBACN,MAAM;YACR;QACF;QAEA,MAAM,SAAS,MAAM,SAAS,IAAI;QAElC,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,OAAO,OAAO,IAAI;QACpC;QAEA,QAAQ,GAAG,CAAC,kCAAkC;QAE9C,OAAO,0LAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT,SAAS,OAAO,OAAO;QACzB;IAEF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,yCAAyC;QACvD,OAAO,0LAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,SAAS;YAAsC,OAAO,MAAM,OAAO;QAAC,GACtF;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}